<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <style>
        body {
            /* display: flex; */
        }
        
        .item {
            margin: 24px;
        }
        
        input {
            width: 100%;
            height: 28px;
        }
        
        select {
            width: 200px;
        }
        
        .title {
            font-size: 24px;
            font-weight: 800;
            background: yellow;
        }
        
        .nft-image {
            width: 600px;
            height: 600px;
        }
    </style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsoneditor@9.9.0/dist/jsoneditor.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jsoneditor@9.9.0/dist/jsoneditor.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/svg.js/3.1.1/svg.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/randomcolor@0.6.2/randomColor.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tweakpane@3.1.0/dist/tweakpane.min.js"></script>
    <script src="http://unpkg.com/fabric/dist/fabric.min.js"></script>
</head>

<body>

    <div class="item">
        <label for="tokenIds">åˆçº¦ä¸‹çš„tokenIdsæŸ¥è¯¢</label>

        <select name="tokenIds" id="tokenIds">
        </select>
        <p>æ£€æŸ¥æœ‰å“ªäº›idå·²ç»å‘äº†</p>
        <div id="tokenIds-result"></div>
    </div>
    <div class="item">
        <p>æŸ¥è¯¢é’±åŒ…åœ°å€ä¸‹çš„nftèµ„äº§</p>
        <input type="text" name="getAddressBalances" id="getAddressBalances">

        <div id="getAddressBalances-result"></div>
    </div>

    <div class="">
        <div class="item">
            <label for="creators">åˆ›ä½œè€…: </label>
            <!-- <input type="text" name="creators" id="creators" required> -->

            <select name="creators" id="creators" multiple="multiple">
          
          </select>


        </div>
        <div class="item">
            <label for="sponsors">èµåŠ©æ–¹ </label>
            <!-- <input type="sponsors" name="sponsors" id="sponsors" required> -->

            <select name="sponsors" id="sponsors" multiple="multiple">
       
          </select>

        </div>
        <div class="item">
            <label for="proposal">ææ¡ˆ</label>
            <select name="proposal" id="proposal"></select>
            <!-- <input type="proposal" name="proposal" id="proposal" autocomplete> -->
        </div>
        <div class="item">
            <label for="skills">æŠ€èƒ½</label>

            <select name="skills" id="skills" multiple="multiple">
               
              </select>

            <!-- <input type="skills" name="skills" id="skills" required> -->
        </div>
        <div class="item">
            <label for="certifications">è®¤è¯</label>
            <!-- <input type="certifications" name="certifications" id="certifications" required> -->

            <select name="certifications" id="certifications" multiple="multiple">
         
            </select>


        </div>
        <div class="item">
            <label for="technicalSupports">æŠ€æœ¯</label>
            <!-- <input type="technicalSupports" name="technicalSupports" id="technicalSupports" required> -->

            <select name="technicalSupports" id="technicalSupports" multiple="multiple">
              
              </select>


        </div>
        <div class="item">
            <label for="description">æè¿°</label>
            <input type="description" name="description" id="description" required autocomplete>
        </div>
        <div class="item">
            <label for="name">åç§°  ï¼Œå¯ä»¥å¾ˆå…·ä½“</label>
            <input type="name" name="name" id="name" required autocomplete>
        </div>


        <div id="editable" contenteditable="true">
            <p>è¿™æ˜¯ä¸€ä¸ªå¯ç¼–è¾‘çš„divåŒºåŸŸ</p>
            <p>å°†å›¾åƒç²˜è´´åˆ°è¿™é‡Œã€‚</p>
        </div>


        <div class="item">
            <label for="fileData">æºæ–‡ä»¶</label>
            <input type="file" name="fileData-input" id="fileData-input" />
            <input type="text" name="fileData" id="fileData" />
            <img src="" id="fileData-preview" style="width:200px" />
        </div>
        <div class="item">
            <label for="filetype">æ–‡ä»¶ç±»å‹</label>
            <input type="filetype" name="filetype" id="filetype" required>
        </div>
        <div class="item">
            <label for="achievements" class="title">ç”¨æˆ·æˆå°± </label>
            <!-- <input type="achievement" name="achievement" id="achievement" required> -->
            <select name="achievements" id="achievements">
               
              </select>
        </div>
        <div class="item">
            <label for="image">å°é¢  â€“ é¢„è§ˆå›¾ - å°ºå¯¸å»ºè®®320x320,640x320ï¼Œæ¨èä½¿ç”¨ipfsé“¾æ¥</label>
            <input type="file" name="image-input" id="image-input" required>
            <input type="text" name="image" id="image">
            <img src="" id="image-preview" style="width:200px" />
        </div>
        <div class="item">
            <label for="aspectRatio">å®½é«˜æ¯”</label>
            <!-- <input type="s" name="s" id="s" required> -->

            <select name="aspectRatio" id="aspectRatio">
                <option value ="1">1 æ­£æ–¹å½¢</option>
                <option value ="2">2 banner</option>
              </select>


        </div>


        <div class="item">
            <button onclick="getForm()">Subscribe</button>
        </div>
    </div>


    <div id="jsoneditor" style="width: 400px; height: 400px;"></div>

    <button id="export">å¯¼å‡º</button>
    <script>
        const contracts_default = {
                "MixDAOå¾½ç« ": "cfx:acd8xca66vh5cdd7rdfpxjkys5muj6yksabk8nfjvm",
                "MixDAOé€šè¡Œè¯": "cfx:acd0sf2e5xyzx3as5etbu7710fzubk034pn3hfapy7"

            }
            // https://confluxscan.net/token/cfx:acd0sf2e5xyzx3as5etbu7710fzubk034pn3hfapy7

        let tokenIdsHtml = '';
        for (const key in contracts_default) {
            tokenIdsHtml += `<option value="${contracts_default[key]}" >åˆçº¦ï¼š${key}</option>`

        };
        document.querySelector('#tokenIds').innerHTML = tokenIdsHtml;
        document.querySelector('#tokenIds').addEventListener('change', async e => {
            getTokenIds(e.target.value).then(res => {
                res.list = Array.from(res.list, t => t.tokenId)
                document.querySelector('#tokenIds-result').innerText = JSON.stringify(res, null, 2)
            })
        })
        async function getTokenIds(d) {
            let res = await fetch(`https://api.confluxscan.net/nft/tokens?contract=${d}`);
            res = await res.json()
            return res.data
        }

        document.querySelector('#getAddressBalances').addEventListener('change', e => {
            getAddressBalances(e.target.value).then(res => {

                document.querySelector('#getAddressBalances-result').innerText = JSON.stringify(res, null, 2)
            })
        })

        async function getAddressBalances(address) {
            let res = await fetch(`https://api.confluxscan.net/nft/balances?limit=10000&owner=${address}`);
            res = await res.json()

            return res.data
        }


        const config = {
            "creators": [{
                "name": "shadow",
                "text": "è®¾è®¡é»‘å®¢",
                "url": "https://github.com/shadowcz007"
            }, {
                "name": "æ½œçŸ³",
                "text": "å¾®ä¿¡å·Einstein_Lannanï¼Œæ¬¢è¿æ¥åˆ°æŸçŸ³çš„Neverlandï¼Œäº²çˆ±çš„å½¼å¾—Â·æ½˜ä»¬ ( â— 'â—¡' â— ) è¿™é‡Œæœ‰æ•…äº‹ï¼ˆæ¨ç†ï¼Œç§‘å¹»ï¼Œå¹½é»˜...ï¼‰ä¹Ÿæœ‰ç¤¾è¯„ï¼Œå½±è¯„ï¼Œå¿ƒç†ä¸“æ ...... æ„¿åŠ©ä½ çš„æ£±è§’ï¼Œå®ˆæŠ¤ä½ çš„è½¯è‚‹ï¼Œä¸è¿™ä¸ªæ–‘æ–“ä¸–ç•Œï¼Œæ¸©æŸ”å…±å¤„ã€‚"
            }, {
                "name": "ç¢³åŸºè‚¥æŸ´",
                "text": "æ— ç•Œæˆå‘˜ML764ï¼Œä¸ä¼šå†™ä»£ç çš„è®¾è®¡å¸ˆä¸æ˜¯å¥½è‚¥å®…ï¼Œä¸€ä¸ªæ¸¸èµ°åœ¨è‰ºæœ¯å’Œç¨‹åºä¹‹é—´çš„äººï¼Œæ¬¢è¿ä¸€èµ·å¥”èµ´æœªæ¥ï¼Œå¼€å¯æ— ç•Œä¹‹æ—…ã€‚",
                "url": "https://www.mrthinker.top"
            }, {
                "name": "ğŸŒ",
                "text": "AIå¯ä»¥åœ¨ç¬é—´é¢ è¦†äººçš„æƒ³è±¡åŠ›ï¼Œä½†å¹¶ä¸ä¼šè¶…è¶Šï¼Œé™¤éæ‘†çƒ‚",
                "url": ""

            }, {
                "name": "æœéŸ¦æŸ¯",
                "text": "è®¾è®¡è·¨å­¦ç§‘æ¢ç´¢è€…ï¼ŒDAOç»„ç»‡å®è·µè€…ï¼Œå…ƒå®‡å®™è®°è€…ç¼–è¾‘",
                "url": ""
            }, {
                "name": "è¿·å¡”åŸMetaCity",
                "text": "è¿·å¡”åŸ1933æ˜¯ä»¥èµ›åšç§‘å¹»å§¿æ€ï¼Œè¿½æ±‚æ½®æµæ‰“å¡çš„æ–‡åŒ–ç©ºé—´ï¼›ä¾æ‰˜1933è€åœºåŠç²¾å¦™ç»“æ„ï¼Œè¿‘10000å¹³çš„ç”µå½±çº§ç§‘å¹»ç½®æ™¯ã€‚åœ¨ä¸åŒçš„åŠ¿åŠ›å»ºç­‘ä¸­ç•™ä¸‹å½±åƒï¼Œåœ¨è¿·å¡”åŸå½°æ˜¾ä¸ªæ€§å§¿æ€ï¼Œä½ å°±æ˜¯èµ›åšä¸–ç•Œçš„ä¸»è§’ã€‚",
                "url": "https://mp.weixin.qq.com/s/U6WIPzgtYZR379UGBEN_ew"
            }],
            "sponsors": [{
                "name": "Mixlabæ— ç•Œç¤¾åŒº",
                "url": "https://github.com/MixLabPro"
            }, {
                "name": "MixDAO",
                "url": "https://github.com/MixDAO-Web3"
            }, {
                "name": "shadowçš„å®éªŒå®¤",
                "url": "https://github.com/shadowcz007"
            }, {
                "name": "è¿·å¡”åŸMetaCity",
                "url": "https://mp.weixin.qq.com/s/U6WIPzgtYZR379UGBEN_ew"
            }],
            "proposal": ["MixDAOé€šè¡Œè¯å’Œå¾½ç« ä½“ç³»å‘å¸ƒ", "MetaCityå¯èˆªæ•°å­—çºªå¿µå¾½ç« "],
            "skills": Array.from(`DAOæ¶æ„å¸ˆ
            æ•°å­—è‰ºæœ¯å®¶
            NFTæ”¶è—å®¶
            äººå·¥æ™ºèƒ½ä¸“å®¶
            å…ƒå®‡å®™åˆ›ä½œè€…
            DAOæˆå‘˜
            è™šæ‹Ÿç©ºé—´è®¾è®¡å¸ˆ
            å¯¼æ¼”
            è®¾è®¡å¸ˆ
            æ½®ç‰Œåº—ä¸»ç†äºº
            æŠ•èµ„äºº
            è·¯äººç”²
            å­¦ç”Ÿ
            è·¨ç•Œäººæ‰
            æ— è¾¹ç•Œå­¦ä¹ è€…
            AIè‰ºæœ¯å®¶
            ç®—æ³•å·¥ç¨‹å¸ˆ
            ç¨‹åºå‘˜
            è®¾è®¡é»‘å®¢
            è‰ºæœ¯é»‘å®¢
            ç§‘å¹»ä½œè€…
            æ¸¸æˆè®¾è®¡å¸ˆ
            ç‹¬ç«‹å¼€å‘è€…
            å¼€æºé¡¹ç›®å‘èµ·äºº
            è€å¸ˆ
            é¡¾é—®
            é¦–å¸­å“ç‰Œå®˜
            é¦–å¸­äº§å“å®˜
            å¢é•¿é»‘å®¢
            ä¸“æ ä½œè€…
            `.trim().split('\n').filter(f => f), a => {
                return {
                    name: a.trim()
                }
            }),
            "certifications": [{
                "name": "MixDAO",
                "url": "https://github.com/MixDAO-Web3"
            }],
            "technicalSupports": [{
                "name": "bigan",
                "url": "http://open.flyray.me"
            }, {
                "name": "anyweb",
                "url": "https://anyweb.cc"
            }, {
                "name": "Stable diffusion",
                "url": "https://github.com/CompVis/stable-diffusion"
            }],
            "achievements": [{
                "name": "Hello MixDAO",
                "text": "ä»Šå¤©ï¼ŒDAOæˆç«‹å•¦~"
            }, {
                "name": "AIç”ŸæˆæŒ‘æˆ˜èµ›",
                "text": "æŒ‘æˆ˜è‡ªæˆ‘ï¼Œé‡è§æ›´å¥½çš„è‡ªå·±"
            }, {
                "name": "é»‘å®¢é©¬æ‹‰æ¾",
                "text": "ä¸€èµ·åä½œï¼Œå°½æƒ…åˆ›é€ "
            }, {
                "name": "ä¹äºåˆ†äº«",
                "text": "æ„Ÿè°¢ä½ çš„æ¯ä¸€æ¬¡æ— ç§åˆ†äº«"
            }, {
                "name": "å¼€æ‹“è€…",
                "text": "æ„Ÿè°¢ä½ çš„æ¯ä¸€æ¬¡æ‰©æ•£"
            }, {
                "name": "Mixlabåˆ›é€ åŠ›å›¢é˜Ÿ",
                "text": "æ¯ä¸€æ¬¡åä½œï¼Œéƒ½ä»£è¡¨ç€ä½ çš„æˆé•¿"
            }, {
                "name": "BookDAOæˆç«‹è¿è¥å°ç»„",
                "text": "æˆç«‹è¿è¥å°ç»„ï¼Œåˆ¶å®šè¯­é›€å…±å»ºæ–‡æ¡£ï¼Œæ­£å¼æ¢ç´¢ã€Šå…ƒå®‡å®™åˆ›æ„å›¾è°±ã€‹çŸ¥è¯†DAO/MixDAOè¿è¥ä¸å•†ä¸šæ¨¡å¼"
            }, {
                "name": "ä¸“æ ä½œè€…",
                "text": "æ„Ÿè°¢ä½ çš„ç³»ç»ŸåŒ–è¾“å‡º"
            }, {
                "name": "Mixå˜‰å®¾",
                "text": "åˆ†äº«æ— é™ï¼Œçªç ´çŸ¥è¯†è¾¹ç•Œ"
            }, {
                "name": "æ— è¾¹ç•Œå­¦ä¹ è€…",
                "text": "è‡´æ•¬è·¨å­¦ç§‘ã€ä¸è®¾é™çš„æŒç»­å­¦ä¹ è€…"
            }, {
                "name": "ææ¡ˆ",
                "text": "ä¸€èµ·è§è¯ä¸‹ä¸€ä¸ªè‹¹æœå’Œè°·æ­Œçš„è¯ç”Ÿ"
            }, {
                "name": "èµ°è®¿è®¡åˆ’",
                "text": "é›¶è·ç¦»ï¼ŒæŒ–æ˜å•†ä¸šæœºä¼š"
            }, {
                "name": "æ¿€æ´»å™¨",
                "text": "è´Ÿè´£æƒ³å‡ºç‚¹å­çš„äººï¼Œåˆ›æ–°çš„ABCDEFæ¨¡å‹çš„A"
            }, {
                "name": "è™šæ‹Ÿç©ºé—´",
                "text": "ä¸€èµ·æ¢ç´¢ç°å®ä¸è™šæ‹Ÿçš„ç¼éš™"
            }, {
                "name": "å¼€æºè§è¯",
                "text": "ä¸€èµ·è§è¯å¼€æºé¡¹ç›®çš„å‘å¸ƒ"
            }, {
                "name": "åšå®¢MixDAO",
                "text": "å¯»æ‰¾å½“ä»£ Crypto è¾¾èŠ¬å¥‡"
            }, {
                "name": "NFTé€šè¡Œè¯",
                "text": "DAOæˆå‘˜çš„å‡­è¯ï¼Œå¼€å¯DAOçš„ç¥ç§˜é€šé“"
            }, {
                "name": "MetaCityå¯èˆª",
                "text": "ä¸–é›†æ–‡æ—…åœ¨2022.9.13å‡ºå‘,å¸¦ç€è¿·å¡”åŸ,å¸¦ç€äººç±»å¯¹å…ƒå®‡å®™çš„æœŸå¾…å’Œå¹»æƒ³,èµ‹äºˆSH1933æ˜Ÿçƒä¸€ä¸ªæµªæ¼«çš„å®šä¹‰"
            }]
        }





        createOptions(config.creators, 'creators')
        createOptions(config.sponsors, 'sponsors')
        createOptions(config.proposal, 'proposal')
        createOptions(config.skills, 'skills')
        createOptions(config.certifications, 'certifications')
        createOptions(config.technicalSupports, 'technicalSupports')
        createOptions(config.achievements, 'achievements')




        function createOptions(objs, id) {

            for (const obj of objs) {
                let option = document.createElement('option');
                option.value = typeof(obj) != 'string' ? JSON.stringify(obj) : obj;
                option.innerText = obj.name || obj;
                document.querySelector('#' + id).appendChild(option)
            }

        }




        // create the editor
        const container = document.getElementById("jsoneditor")
        const options = {}
        let editor = new JSONEditor(container, options)

        document.querySelector('#fileData-input').addEventListener('change', async e => {
            let file = e.target.files[0];

            document.querySelector('#filetype').value = file.type;
            document.querySelector('#name').value = file.name.split('.')[0];
            let res = await uploadFileData();
            console.log(file.type, file, res)
            document.querySelector('#fileData').value = res.data.fileUrl;
            if (file.type.match('image')) {
                document.querySelector('#fileData-preview').src = res.data.fileUrl

            }
        });
        document.querySelector('#image-input').addEventListener('change', async e => {
            let file = e.target.files[0];
            console.log(file.type, file)
            if (file.type.match('image')) {
                let res = await uploadImage();
                console.log(file.type, file, res)
                document.querySelector('#image').value = res.data.fileUrl;
                document.querySelector('#image-preview').src = res.data.fileUrl;
                document.querySelector('#image-preview').onload = () => {
                    document.querySelector('#aspectRatio').value = document.querySelector('#image-preview').naturalWidth / document.querySelector('#image-preview').naturalHeight
                }

            }
            // document.querySelector('#filetype').value=file.type;
            // document.querySelector('#name').value=file.name.split('.')[0];

        });

        document.querySelector('#export').addEventListener('click', e => {
            window.res = editor.get();
            console.log(window.res)
        })

        createSkills(config.skills);

        function getForm() {

            let json = {
                creators: [],
                sponsors: [],
                proposal: {},
                skills: [],
                certifications: [],
                technicalSupports: [],
                image: '',
                fileData: '',
                filetype: '',
                aspectRatio: 1,
                achievements: '',
                // contract: '',
                description: '',
                name: ''
            }
            for (const key in json) {
                let t = document.querySelector(`#${key}`);
                if (t) json[key] = t.value;
                if (key == 'achievements') json[key] = JSON.parse(t.value);
                if (t && t.getAttribute('multiple') === 'multiple') {
                    json[key] = [];
                    for (const option of t.querySelectorAll('option')) {
                        if (option.selected == true) {
                            json[key].push(['certifications', 'creators', 'sponsors', 'technicalSupports'].includes(key) ? JSON.parse(option.value) : option.value);
                        }
                    }
                }
                if (key === 'aspectRatio') json[key] = parseFloat(json[key])
            }

            form2json(json)
        }

        function createSkills(skills) {
            let html = '';

            for (const s of skills) {
                html += `<option value="${s.name.trim()}">${s.name.trim()}</option>`;
            }
            document.querySelector('#skills').innerHTML = html;
        }

        function form2json(json) {


            // set json
            // const initialJson = {
            //     "Array": [1, 2, 3],
            //     "Boolean": true,
            //     "Null": null,
            //     "Number": 123,
            //     "Object": {"a": "b", "c": "d"},
            //     "String": "Hello World"
            // }
            editor.set(json)
            console.log(JSON.stringify(editor.get()))
        }

        // åˆçº¦åœ°å€ https://testnet.confluxscan.net/token/cfxtest:ace2w11u4g65jajzefbx2hf1yk2nesk8fu6fa4wxzn
        // ç¡®å®šå“ªäº›ç©ºæŠ•äº†
        //post http://114.116.93.253:8097/ipfsUpload

        async function uploadFileData() {
            return await upload(document.getElementById("fileData-input"))
        }
        async function uploadImage() {
            return await upload(document.getElementById("image-input"))
        }
        async function upload(ip) {

            if (ip.files.length === 0) {
                alert("è¯·é€‰æ‹©ä¸Šä¼ æ–‡ä»¶")
                return false;
            }

            const formData = new FormData();
            formData.append("file", ip.files[0]);
            const url = "http://114.116.93.253:8097/ipfsUpload";
            const res = await fetch(url, {
                method: "POST",
                body: formData //è‡ªåŠ¨ä¿®æ”¹è¯·æ±‚å¤´,formdataçš„é»˜è®¤è¯·æ±‚å¤´çš„æ ¼å¼æ˜¯ multipart/form-data
            })

            return await res.json();

        }

        function str2URL(data, type) {
            // svg "image/svg+xml;charset=utf-8"
            var blob = new Blob([data], {
                type: type
            })
            return URL.createObjectURL(blob)
        }

        function createCanvas(width, height) {
            let canvas = document.createElement('canvas')
            canvas.width = width
            canvas.height = height
            return canvas
        }

        function downloadFile(url, filename) {
            console.log(url)
            if (!url) return
            let link = document.createElement('a')
            link.style.display = 'none'
            link.href = url
            link.setAttribute('download', filename)
                // document.body.appendChild(link) 
            link.click()
                // document.body.removeChild(link);
        }

        function svg2base64(svgStr = null, type = 'png', width = null, height = null) {
            if (!svgStr) return
            return new Promise((resolve, reject) => {
                let url = str2URL(svgStr, 'image/svg+xml;charset=utf-8')
                let img = new Image();
                img.onload = () => {
                    width = width || img.width * 2
                    height = height || img.height * 2
                    let canvas = createCanvas(width, height)
                    let ctx = canvas.getContext('2d')
                    ctx.drawImage(img, 0, 0, width, height)
                    let base64 = canvas.toDataURL(`image/${type}`)
                    URL.revokeObjectURL(url)
                    resolve(base64)
                }
                img.src = url
            })
        }

        function create(text = 'ä½ å¥½å‘€ï¼Œæ¬¢è¿åŠçˆ±å¦‚ åŸºé‡‘ä¼š mixldao mixlab  æ–¤æ–¤è®¡è¾ƒ') {
            return fetch('01.svg').then(r => r.text()).then(t => {
                let s = SVG();
                s.svg(t);
                let svg = s.children()[0];
                svg.findOne('#font').attr('startOffset', Math.round(Math.random() * 200)).text(text);
                svg.findOne('#board-02').attr('stroke', window._colors[Math.round(Math.random() * 10)])
                svg.findOne('text').dom = {};
                svg.findOne('textPath').dom = {};
                svg.findOne('tspan').dom = {};
                // svg2base64(svg.svg()).then(url => downloadFile(url));
                //document.body.appendChild(s.children()[0].node)
                return svg
            })
        }

        function addImg(svg, base64) {

            let im = svg.findOne('#img');
            im.svg(`<image x=\"${im.attr('x')}\" y=\"${im.attr('y')}\" width=\"${im.attr('width')}\" height=\"${im.attr('height')}\" xlink:href=\"${base64}\"></image>`)
            return svg
        }

        function blobToDataURL(blob, cb) {
            let reader = new FileReader();
            reader.onload = function(evt) {
                let base64 = evt.target.result;
                cb(base64);
            };
            reader.readAsDataURL(blob);
        };

        function textParse(text) {
            var pattern2 = new RegExp("[A-Za-z]+");

            text = Array.from(text.split(""), t => {
                return pattern2.test(t) ? t : ' ' + t + ' '
            }).join("").replace(/\s+/gi, ' ')

            return text
        }

        function pasteImg(e) {
            // console.log(e)
            if (e.clipboardData.items) {
                ele = e.clipboardData.items
                for (var i = 0; i < ele.length; ++i) {
                    if (ele[i].kind == 'file' && ele[i].type.indexOf('image/') !== -1) {
                        var blob = ele[i].getAsFile();
                        let data = editor.get();
                        blobToDataURL(blob, base64 => {
                            create(
                                textParse(data.name + ' - ' + Array.from(data.sponsors, s => s.name).join(' & '))
                            ).then(svg => {
                                svg = addImg(svg, base64);

                                svg2base64(svg.svg(), 'nft').then(base64 => {
                                    let im = new Image();
                                    im.className = 'nft-image'
                                    im.src = base64;
                                    document.body.appendChild(im);
                                })
                            })
                        })

                    }

                }
            } else {
                alert('non-chrome');
            }
        }

        document.getElementById('editable').onpaste = function() {
            getForm()
            pasteImg(event);
            return false;
        };
        createColors()

        function createColors(n = 10) {
            window._colors = []
            const pane = new Tweakpane.Pane();
            let colorsMap = {};
            Array.from(new Array(10), a => {
                let c = randomColor();
                colorsMap[c] = c;
                pane.addInput(colorsMap, c);
                window._colors.push(c)
            });
            pane.on('change', (e) => {
                console.log('changed: ' + JSON.stringify(e.value));
            });
        }
    </script>
</body>

</html>